@model MMSite6.Models.OrderDetailsViewModel

@{
	ViewData["Title"] = "Details";
}

<h1>Order Details</h1>

<div>
	<hr />
	<dl class="row">
		<dt class="col-sm-2 text-primary">
			@Html.DisplayNameFor(model => model.order.summary)
		</dt>
		<dd class="col-sm-10 text-primary">
			@Html.DisplayFor(model => model.order.summary)
		</dd>
		<dt class="col-sm-2 text-primary">
			@Html.DisplayNameFor(model => model.order.desc)
		</dt>
		<dd class="col-sm-10 text-primary">
			@Html.DisplayFor(model => model.order.desc)
		</dd>
		<dt class="col-sm-2 text-primary">
			@Html.DisplayNameFor(model => model.order.orderDate)
		</dt>
		<dd class="col-sm-10 text-primary">
			@Html.DisplayFor(model => model.order.orderDate)
		</dd>
		<dt class="col-sm-2 text-primary">
			@Html.DisplayNameFor(model => model.order.status)
		</dt>
		<dd class="col-sm-10 text-primary">
			@Html.DisplayFor(model => model.order.status)
		</dd>
		<dt class="col-sm-2 text-primary">
			Name
		</dt>
		<dd class="col-sm-10 text-primary">
			@Html.DisplayFor(model => model.order.user.firstName)
			@Html.DisplayFor(model => model.order.user.lastName)
		</dd>
		<dt class="col-sm-2 text-primary">
			Total Cost:
		</dt>
		<dt class="col-sm-2 text-primary">
			$@ViewBag.totalCost
		</dt>
	</dl>
	<h5 class="text-primary">
		Locations
	</h5>
	<table class="table">
		<tr class="text-primary">
			<th>Address</th>
			<th>Approx. SqFt</th>
			<th>Estimate Cost</th>
			<th>Floor Plan</th>
		</tr>
		@foreach (var item in Model.item)
		{
			<tr class="text-primary">
				<td>@item.address</td>
				<td>@item.sqft</td>
				<td>$@item.estimateCost</td>
				<td>
					@if (Model.order.status == OrderStatus.Paid || User.IsInRole("Admin"))
					{
						@foreach (var document in item.document)
						{
							<a href="@document.documentPath">Download</a>

							@if (User.Identity.IsAuthenticated)
							{
								@if (User.IsInRole("Admin"))
								{
									<a> | </a>
									<a asp-controller="Documents" asp-action="Delete" asp-route-id="@document.fileId">Remove Document</a>
								}
							}
						}
					}
				</td>
				<td>
					@if (User.Identity.IsAuthenticated)
					{
						@if (User.IsInRole("Admin"))
						{
							<a asp-controller="Items" asp-action="Edit" asp-route-id="@item.itemId">Edit</a>
						}
					}
				</td>
			</tr>
		}
	</table>
</div>
<div>
	@if (User.Identity.IsAuthenticated)
	{
		@if (User.IsInRole("Admin"))
		{
			<a asp-action="Edit" asp-route-id="@Model.order.orderId">Edit</a>
			<a> | </a>
		}
	}
	<a asp-action="Index">Back to List</a>
</div>